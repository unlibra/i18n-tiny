"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[871],{5823(e,t,n){n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>x,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"next/api-reference/proxy","title":"Proxy","description":"Next.js middleware for automatic locale detection and routing.","source":"@site/docs/next/api-reference/proxy.md","sourceDirName":"next/api-reference","slug":"/next/api-reference/proxy","permalink":"/i18n-tiny/next/api-reference/proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/unlibra/i18n-tiny/tree/main/website/docs/next/api-reference/proxy.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"nextSidebar","previous":{"title":"Core","permalink":"/i18n-tiny/next/api-reference/core"},"next":{"title":"Router","permalink":"/i18n-tiny/next/api-reference/router"}}');var d=n(4848),c=n(8453);const l={sidebar_position:2},s="Proxy",i={},o=[{value:"<code>create(config)</code>",id:"createconfig",level:2},{value:"<code>detectLocale(acceptLanguage, supportedLocales)</code>",id:"detectlocaleacceptlanguage-supportedlocales",level:2}];function a(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.header,{children:(0,d.jsx)(t.h1,{id:"proxy",children:"Proxy"})}),"\n",(0,d.jsx)(t.p,{children:"Next.js middleware for automatic locale detection and routing."}),"\n",(0,d.jsx)(t.h2,{id:"createconfig",children:(0,d.jsx)(t.code,{children:"create(config)"})}),"\n",(0,d.jsx)(t.p,{children:"Creates a Next.js Proxy (Middleware) handler for i18n routing."}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Parameter"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.th,{children:"Default"}),(0,d.jsx)(t.th,{children:"Description"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"locales"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"readonly string[]"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.td,{children:"-"}),(0,d.jsx)(t.td,{children:"Array of supported locales"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"defaultLocale"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"string"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.td,{children:"-"}),(0,d.jsx)(t.td,{children:"Default locale for redirects"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"fallbackLocale"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"string"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"}}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"defaultLocale"})}),(0,d.jsx)(t.td,{children:"Fallback if detection fails"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"prefixDefault"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"boolean"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"}}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"false"})}),(0,d.jsx)(t.td,{children:"Whether to prefix the default locale in URLs"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"detectLanguage"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"boolean"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"}}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"true"})}),(0,d.jsx)(t.td,{children:"Whether to detect language from Accept-Language header"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"routing"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"'rewrite'"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"}}),(0,d.jsx)(t.td,{children:"-"}),(0,d.jsx)(t.td,{children:"SSR rewrite mode (mutually exclusive with prefixDefault/detectLanguage)"})]})]})]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Returns:"})}),"\n",(0,d.jsxs)(t.ul,{children:["\n",(0,d.jsxs)(t.li,{children:[(0,d.jsx)(t.code,{children:"(request: NextRequest) => NextResponse | void"}),": Next.js middleware function."]}),"\n"]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Routing Behavior Matrix:"})}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"prefixDefault"}),(0,d.jsx)(t.th,{children:"detectLanguage"}),(0,d.jsxs)(t.th,{children:["Behavior at ",(0,d.jsx)(t.code,{children:"/"})]})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"false"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"false"})}),(0,d.jsx)(t.td,{children:"Serves fallbackLocale, no detection"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"false"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"true"})}),(0,d.jsx)(t.td,{children:"Detects, redirects non-default, rewrites default"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"true"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"false"})}),(0,d.jsxs)(t.td,{children:["Redirects to ",(0,d.jsx)(t.code,{children:"/[defaultLocale]"})]})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"true"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"true"})}),(0,d.jsx)(t.td,{children:"Detects and redirects to detected locale"})]})]})]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Example:"})}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-typescript",children:"// Default: Language detection, non-default redirects, default rewrites\nexport const proxy = create({\n  locales: ['en', 'ja'],\n  defaultLocale: 'en'\n})\n\n// Always prefix all locales (including default)\nexport const proxy = create({\n  locales: ['en', 'ja'],\n  defaultLocale: 'en',\n  prefixDefault: true\n})\n\n// SSR rewrite mode (locale in x-locale header)\nexport const proxy = create({\n  locales: ['en', 'ja'],\n  defaultLocale: 'en',\n  routing: 'rewrite'\n})\n"})}),"\n",(0,d.jsx)(t.h2,{id:"detectlocaleacceptlanguage-supportedlocales",children:(0,d.jsx)(t.code,{children:"detectLocale(acceptLanguage, supportedLocales)"})}),"\n",(0,d.jsxs)(t.p,{children:["Detects the best matching locale from the Accept-Language header.\nCan be imported directly from ",(0,d.jsx)(t.code,{children:"@i18n-tiny/next/proxy"}),"."]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,d.jsxs)(t.table,{children:[(0,d.jsx)(t.thead,{children:(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.th,{children:"Parameter"}),(0,d.jsx)(t.th,{children:"Type"}),(0,d.jsx)(t.th,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.th,{children:"Description"})]})}),(0,d.jsxs)(t.tbody,{children:[(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"acceptLanguage"})}),(0,d.jsxs)(t.td,{children:[(0,d.jsx)(t.code,{children:"string"})," | ",(0,d.jsx)(t.code,{children:"null"})]}),(0,d.jsx)(t.td,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.td,{children:"Value of Accept-Language header"})]}),(0,d.jsxs)(t.tr,{children:[(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"supportedLocales"})}),(0,d.jsx)(t.td,{children:(0,d.jsx)(t.code,{children:"readonly string[]"})}),(0,d.jsx)(t.td,{style:{textAlign:"center"},children:"Required"}),(0,d.jsx)(t.td,{children:"Array of supported locales"})]})]})]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Returns:"})}),"\n",(0,d.jsxs)(t.ul,{children:["\n",(0,d.jsxs)(t.li,{children:[(0,d.jsx)(t.code,{children:"string | null"}),": The matched locale, or ",(0,d.jsx)(t.code,{children:"null"})," if no match is found."]}),"\n"]}),"\n",(0,d.jsx)(t.p,{children:(0,d.jsx)(t.strong,{children:"Example:"})}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-typescript",children:"import { detectLocale } from '@i18n-tiny/next/proxy'\n\nconst locale = detectLocale(request.headers.get('accept-language'), ['en', 'ja'])\n"})})]})}function x(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453(e,t,n){n.d(t,{R:()=>l,x:()=>s});var r=n(6540);const d={},c=r.createContext(d);function l(e){const t=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:l(e.components),r.createElement(c.Provider,{value:t},e.children)}}}]);